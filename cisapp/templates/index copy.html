{% extends 'basic.html' %}
{% load static  %}
{%block title%}INCLINE{% endblock %}
{%block css%}	<!--  Bootstrap icon -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<!-- Optional: Leaflet markercluster plugin -->
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
<!-- Bokeh CDN resources -->
<link href=”http://cdn.pydata.org/bokeh/release/bokeh-3.4.0.min.css" rel=”stylesheet” type=”text/css”>
<link href=”http://cdn.pydata.org/bokeh/release/bokeh-widgets-3.4.0.min.css" rel=”stylesheet” type=”text/css”>

<style>@media (min-width: 1200px) {
    #data-customised{
        max-width: 100vw;
    }
}
@media (min-width: 992px) {
    #data-customised{
        max-width: 100vw;
    }
}
@media (min-width: 768px) {
    #data-customised{
        max-width: 100vw;
    }
}
@media (min-width: 576px) {
    #data-customised{
        max-width: 100vw;
    }
}
</style>

{%endblock%}
{%block body%}
<body id="home" data-spy="scroll" data-target=".navbar-nav" data-offset="80">
	

	<!--====================================
Welcome Slider
==================================== -->

	<section class="hero-area overlay " style="background-image: url('{% static 'img/banner/hero-area1.jpg' %}');">
		<!-- <video autoplay muted loop class="hero-video">
		<source src="images/banner/hero-video.mp4" type="video/mp4">
	</video> -->
		<div class="block ">
			<div class="video-button mb-5">
				<a class="popup-video" href="https://youtu.be/3yST-yKO21s?si=Koprk1PauJSz1VcV">
					<i class="tf-ion-play"></i>
				</a>
			</div>
			<div>
				<h1>Welcome to <span style="color: rgb(21, 248, 240);">In</span>dian <span
						style="color: rgb(21, 248, 240);">Cl</span>imate <span
						style="color:rgb(21, 248, 240);">in</span>formation <span
						style="color: rgb(21, 248, 240);">e</span>xplorer
				</h1>
				<h3><br>CLIMATE INFORMATION SYSTEM FOR INDIA</h3>
			</div>
			<div class="container">
				<div class="row">
					<div class="col">
						<!-- Temperature Bar Icon -->
						<h2><br><span style="color: rgb(21, 248, 240);"><i
									class="fas fa-thermometer-half fa-2xL"></i></span>
							<!-- Snow Icon -->
							<span style="color: rgb(21, 248, 240);"><i class="fas fa-snowflake  fa-2xL"></i></span>
							<!-- Sun Icon -->
							<span style="color: rgb(21, 248, 240);"><i class="fas fa-sun  fa-2xL"></i></span>
							<!-- Precipitation Icon -->
							<span style="color: rgb(21, 248, 240);"><i class="fas fa-cloud-rain fa-2xL"></i></span>
						</h2>
					</div>
				</div>
			</div>

			<a href="about" class="btn btn-transparent smooth-scroll">Explore Us</a>
		</div>
	</section>

	<!--====================================
	 Start Services Section
==================================== -->

	

	<section id="data" class="bg-one section">
		<div class="container" id="data-customised" style="width:100vw !important;">
			<div class="row" style="margin:0px !important;">

				<div class="col-lg-12">
					<!-- section title -->
					<div class="title text-center wow fadeIn" data-wow-duration="500ms">
						<h2>The <span class="color">Data</span></h2>
						<div class="border"></div>
					</div>
					<!-- /section title -->
				</div>
				
				<!-- single blog post -->
				<article class="col-lg-7 col-md-7 wow fadeInUp" data-wow-duration="500ms" >
					<div class="post-block">
						<div class="media-wrapper">
							<div id="button-holder" style="width:100%;">
							<span id="radio_index" style="display: inline-block;margin-top:0px; margin-left:2%; width:35%; margin-right:2%;">
								<input type="radio" id="showPrecipitation" name="plotType" value="showPrecipitation" checked>
								<label for="showPrecipitation">Precipitation</label>
								<input type="radio" id="showwindspeed" name="plotType" value="showwindspeed">
								<label for="showwindspeed">Tmax</label>
								<input type="radio" id="showtemp" name="plotType" value="showtemp">
								<label for="showtemp">Tmin</label>
							</span>
							<span id="address" style="width:59%; margin-right:1%; display:inline-block;
							   white-space: nowrap; /* Prevents the text from wrapping to the next line */
								overflow: hidden; /* Hides any overflow that exceeds the width */
								text-overflow: ellipsis; /* Adds '...' at the end if the text overflows */
								direction: rtl; /* Aligns text from the right side */
								text-align: left; /* Aligns the text content to the left (keeping the right-to-left reading order) */
								padding-right: 5px; /* Optional: add some padding to separate text from the edge */
							"></span>
						</div>
							<!-- Graph canvas -->
							<div id="map" style="height: 600px; width:100%;"></div>
							{% comment %} <canvas id="myChart" width="400" height="400"></canvas> {% endcomment %}


							
						</div>
					</div>
				</article>
				<!-- /single blog post -->
				
				
				<!-- single blog post -->
				<article class="col-lg-5 col-md-5 wow fadeInUp" data-wow-duration="500ms" style="">
					<div class="post-block">
						<div class="media-wrapper">
							<!-- Graph canvas -->
							<div id="mplot" style="height: 639px; width:100%; overflow:hidden;"></div>
							{% comment %} <canvas id="myChart" width="400" height="400"></canvas> {% endcomment %}


							
						</div>
					</div>
				</article>
				<!-- /single blog post -->
				<!-- single blog post -->
				<article class="col-lg-8 col-md-6 wow fadeInUp" data-wow-duration="500ms">
					<div class="post-block">
						<div class="media-wrapper">
							
							
							


							
						</div>
					</div>
				</article>
				
			</div> <!-- End row -->
		</div> <!-- End container -->
	</section> <!-- End section -->

	<!--====================================
Start Call To Action
==================================== -->
	<section class="call-to-action section-sm bg-2 overly" style="background-image: url('{% static 'img/backgrounds/bg-2.jpg' %}');">
		<div class="container">
			<div class="row">
				<!-- <div class="col-md-12 text-center">
					<h2 style="color: white;">QUALITY RESEARCH IS QUALITY DATA</h2> -->
					<!-- <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Officiis tenetur odio impedit incidunt? <br> Omnis accusantium ea reiciendis, fugit commodi nostrum.</p> -->
					<!-- <a href="data/map/watersheds/watersheds.html" class="btn btn-main">More Data</a>
				</div> -->
			</div> <!-- End row -->
		</div> <!-- End container -->
	</section> <!-- End section -->

	<!--====================================
	 Start Apps Section
=========================================== -->
	<section id="Apps" class="section">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<!-- section title -->
					<div class="title text-center wow fadeInDown">
						<h2> Climate <span class="color">Apps</span></h2>
						<div class="border"></div>
					</div>
					<!-- /section title -->
				</div>

				<!-- single Apps post -->
				<article class="col-lg-4 col-md-6 wow fadeInUp" data-wow-duration="500ms">
					<div class="post-block">
						<div class="media-wrapper">
							<img src="{% static 'img/Apps/Apps-1.jpg' %}" alt="amazing caves coverimage" class="img-fluid">
						</div>
						<div class="content">
							<h3><a href="delineation/dl">Incline Watershed Delineation App</a></h3>
							<p>Find downstream delineation data at any point. You can also download results.
							</p>
							<a class="btn btn-transparent" href="dl-blog">Read More</a>
													</div>
					</div>
				</article>
				<!-- /single Apps post -->

				<!-- single Apps post -->
				<article class="col-lg-4 col-md-6 wow fadeInUp" data-wow-duration="500ms" data-wow-delay="200ms">
					<div class="post-block">
						<div id="gallery-post" class="media-wrapper">
							<div class="item">
								<img src="{% static 'img/Apps/Apps-1.jpg' %}" alt="Apps" class="img-fluid">
							</div>
							<div class="item">
								<img src="{% static 'img/Apps/Apps-3.jpg' %}" alt="Apps" class="img-fluid">
							</div>
							<div class="item">
								<img src="{% static 'img/Apps/Apps-2.jpg' %}" alt="Apps" class="img-fluid">
							</div>
						</div>

						<div class="content">
							<h3><a href="side-by-side">Climate Impact Snapshot App</a></h3>
							<p>Get Climate based data and plot. You can also compare different raster layers.
							</p>
							<a class="btn btn-transparent" href="climate-snapshot-blog">Read More</a>
												</div>
					</div>
				</article>
				<!-- end single Apps post -->

				<!-- single Apps post -->
				<article class="col-lg-4 col-md-6 wow fadeInUp" data-wow-duration="500ms" data-wow-delay="400ms">
					<div class="post-block">
						<div class="media-wrapper">
							<img src="{% static 'img/Apps/Apps-6.jpg' %}" alt="amazing caves coverimage" class="img-fluid">
						</div>

						<div class="content">
							<h3><a href="Apps.html">App</a></h3>
							<p>App.App.App. App.App.App.App. App.App.App.App.App. App.App.App.App. App. App.App.App.App.</p>
							<a class="btn btn-transparent" href="Apps-single.html">Read</a>
												</div>
					</div>
				</article>
				<!-- end single blog post -->

				<div class="col-12">
					<div class="all-post text-center">
						<a class="btn btn-main" href="apps">View All Apps</a>
					</div>
				</div>
			</div> <!-- end row -->
		</div> <!-- end container -->
	</section> <!-- end section -->

	<!--====================================
Start Call To Action
==================================== -->
	<section class="call-to-action section-sm bg-1 overly" style="background-image: url('{% static 'img/backgrounds/bg-1.jpg' %}');">
		<div class="container">
			<div class="row">
				<div class="col-md-12 text-center">
					<h2 style="color: white;">GREAT RESEARCH & INCREDIBLE ASSISTANCE</h2>
					<a href="#" class="btn btn-main">Start a project with us</a>
				</div>
			</div> <!-- End row -->
		</div> <!-- End container -->
	</section> <!-- End section -->


	<!--====================================
	 Start Services Section
==================================== -->
	<section id="services" class="bg-dark section section-bg">
		<div class="container">
			<div class="row">

				<div class="col-lg-12">
					<!-- section title -->
					<div class="title text-center wow fadeIn" data-wow-duration="500ms">
						<h2>Our <span class="color">Services</span></h2>
						<div class="border"></div>
					</div>
					<!-- /section title -->
				</div>

				<!-- Single Service Item -->
				<article class="col-lg-4 col-md-6 wow fadeInUp" data-wow-duration="500ms">
					<div class="service-block text-center">
						<div class="service-icon text-center">
							<i class="tf-globe"></i>
						</div>
						<h3>Service1</h3>
						<p>Service.Service.Service. Service.Service.Service.Service. Service.Service.Service.Service.
							Service.Service.Service.Service. Service.
						</p>
					</div>
				</article>
				<!-- End Single Service Item -->

				<!-- Single Service Item -->
				<article class="col-lg-4 col-md-6 wow fadeInUp" data-wow-duration="500ms" data-wow-delay="200ms">
					<div class="service-block text-center">
						<div class="service-icon text-center">
							<i class="tf-ion-laptop"></i>
						</div>
						<h3>Service2</h3>
						<p>Service.Service.Service. Service.Service.Service.Service. Service.Service.Service.Service.
							Service.Service.Service.Service. Service.</p>
					</div>
				</article>
				<!-- End Single Service Item -->

				<!-- Single Service Item -->
				<article class="col-lg-4 col-md-6 wow fadeInUp" data-wow-duration="500ms" data-wow-delay="400ms">
					<div class="service-block text-center">
						<div class="service-icon text-center">
							<i class="tf-genius"></i>
						</div>
						<h3>Service3</h3>
						<p>Service.Service.Service. Service.Service.Service.Service. Service.Service.Service.Service.
							Service.Service.Service.Service. Service.</p>
					</div>
				</article>
				<!-- End Single Service Item -->
				<div class="col-12">
					<div class="all-post text-center">
						<a class="btn btn-main" href="services.html">View All Services</a>
					</div>
				</div>



			</div> <!-- End row -->
		</div> <!-- End container -->
	</section> <!-- End section -->



{%endblock%}
{%block script%}	

<script src="https://cdn.bokeh.org/bokeh/release/bokeh-3.4.0.min.js"></script>
<script src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.4.0.min.js"></script>
<script src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.4.0.min.js"></script>
<script src="https://cdn.bokeh.org/bokeh/release/bokeh-api-3.4.0.min.js"></script>
<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<!-- Main jQuery -->
	<script src="{% static 'plugins/jquery/jquery.min.js' %}"></script>
	<!-- Bootstrap 3.1 -->
	<script src="{% static 'plugins/bootstrap/bootstrap.min.js' %}"></script>
	<!-- Slick Carousel -->
	<script src="{% static 'plugins/slick-carousel/slick.min.js' %}"></script>
	<!-- Portfolio Filtering -->
	<script src="{% static 'plugins/filterzr/jquery.filterizr.min.js' %}"></script>
	<!-- Magnific popup -->
	<script src="{% static 'plugins/magnific-popup/dist/jquery.magnific-popup.min.js' %}"></script>
	<!-- Google Map API -->
	<script src="{% static 'plugins/google-map/gmap.js' %}"></script>
	<!-- wow.min Script -->
	<script src="{% static 'plugins/wow/wow.min.js' %}"></script>
	<!-- Custom js -->
	<script src="{% static 'js/script.js' %}"></script>
	{% comment %} 
	<script src="{% static 'js/functionality.js' %}"></script> {% endcomment %}


<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>


<!-- Script to create the map -->
							<script>
								
							// Set up the map
							var map = L.map('map').setView([22, 84], 5);
							// Set the marker
							var marker = L.marker([22, 84]).addTo(map);
							// Hide marker initially
							marker.setOpacity(10);

							// Add OpenStreetMap as the base layer
							L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
								attribution: '© OpenStreetMap contributors'
							}).addTo(map);
							
							


							var globalLat=22;
							var globalLng=84;
							var currentPlotType="showPrecipitation"; 
							//var currentPlotType="showtemp";
							var currentAddress="";
							var ghtml;

							getOut(globalLat, globalLng);
							console.log(globalLat,globalLng);

							map.on('click', function (e) {
								var latlng = e.latlng;
								var lat=latlng.lat;
								var lng=latlng.lng
								globalLat=lat;
								globalLng=lng;
								console.log(lat,lng);


								// Zoom to the searched location and place a draggable marker
								map.setView([lat, lng], 10);
								// Add marker to the clicked location
								if (marker) {
									map.removeLayer(marker); // Remove previous marker if it exists
								}
								marker = L.marker(latlng).addTo(map); // Add new marker
								// Show marker
								marker.setOpacity(1);

								


								if (currentPlotType === 'showPrecipitation') {
									getOut(globalLat, globalLng);
								} else if (currentPlotType === 'showwindspeed') {
									getOutw(globalLat, globalLng);
								} else if (currentPlotType === 'showtemp') {
									getOutT(globalLat, globalLng);
								}
								


							
								

							});

							// Attach event listeners to radio buttons
							document.querySelectorAll('input[name="plotType"]').forEach(function(radio) {
								radio.addEventListener('change', function () {
									var plotType = this.value;
									currentPlotType=plotType;
									
									if (globalLat && globalLng) {
										if (plotType === 'showPrecipitation') {
											getOut(globalLat, globalLng);
										} else if (plotType === 'showwindspeed') {
											getOutw(globalLat, globalLng);
										} else if (plotType === 'showtemp') {
											getOutT(globalLat, globalLng);
										}
									} else {
										document.getElementById('address').innerHTML = 'Select the location first';
									}
								});
							});


								// Function to fetch data for Precipitation
							function getOut(lat, lng) {
								var urlData = "{% url 'ppt_view_netcdf_annual' %}?lat=" + lat + "&lng=" + lng;
								fetchData(urlData);
								getAddressFromLatLng(lat, lng);
							};

								// Function to fetch data for Wind Speed
							function getOutw(lat, lng) {
								var urlData = "{% url 'tmax_view_netcdf_annual' %}?lat=" + lat + "&lng=" + lng;
								fetchData(urlData);
								getAddressFromLatLng(lat, lng);
							};

								// Function to fetch data for Temperature
							function getOutT(lat, lng) {
								var urlData = "{% url 'tmin_view_netcdf_annual' %}?lat=" + lat + "&lng=" + lng;
								fetchData(urlData);
								getAddressFromLatLng(lat, lng);
							};

							function replaceText(originalText, searchText, replacementText) {
								const startIndex = originalText.indexOf(searchText);
								if (startIndex !== -1) {
									const endIndex = startIndex + searchText.length;
									const newText = originalText.substring(0, startIndex) + replacementText + originalText.substring(endIndex);
									return newText;
								} else {
									return originalText; // Search text not found
								}
								}

							function erasebokehscripts(){
								// Get all script elements with the class name 'remove-this-script'
								const scriptsToRemove = document.body.getElementsByClassName('mplot-script');
								for (let i = 0; i < scriptsToRemove.length; i++) {
								document.body.removeChild(scriptsToRemove[i]);
								}
							}
							function loadbokehscripts(){
								// Get the new width and height of the container
								var newWidth = $('#mplot').width();
								var newHeight = $('#mplot').height();
								var width=newWidth*0.85;
								var height=newHeight*0.95;
								/*var width=gmplotwidth;
								var height=gmplotheight;*/ 
								/*I commented global variables because on every mouse move event global height changes but sometimes it give undefined values So, we are not using it here. */ 
								/*var height=bottomDivNewLocation; */
								const searchText = '{"width":100,"height":100,';
								const replacementText = `{"width":${width},"height":${height},`;
								
								// Find and execute the script within the inserted HTML
								const scripts = document.getElementById('mplot').getElementsByTagName('script');
								document.getElementById('mplot').innerHTML = ghtml;
								for (let i = 0; i < scripts.length; i++) {
									const script = document.createElement('script');
									const newTextContent = replaceText(scripts[i].textContent, searchText, replacementText);
									script.textContent = newTextContent;
									script.classList.add('mplot-script');
									document.body.appendChild(script);
								}
								
							}

								// Function to fetch data using Fetch API
							function fetchData(urlData) {
								fetch(urlData)
									.then(response => response.text())
									.then(html => {
										ghtml=html;
										// Adjust the inner contents accordingly
										erasebokehscripts();
										loadbokehscripts();
									})
									.catch(error => {
										console.error("Error:", error);
									});
							};
							console.log(currentAddress);
							function getAddressFromLatLng(lat, lng) {
								// Construct the API URL
								var apiUrl = `https://nominatim.openstreetmap.org/reverse?format=geojson&lat=${lat}&lon=${lng}
									`;

								// Make a GET request
								fetch(apiUrl)
									.then(response => response.json())
									.then(data => {
									// Access the display_name property inside the first feature
									var displayName = data.features[0].properties.display_name;
									currentAddress=displayName;
									console.log(currentAddress);
									document.getElementById('address').innerHTML = currentAddress;
									})
									.catch(error => {
										console.error("Error:", error);
									});
							}
							$(window).resize(function() {
								// Adjust the inner contents accordingly
								erasebokehscripts();
								loadbokehscripts();
							});

								
							</script> 





	{%endblock%}
